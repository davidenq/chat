!function(){"use strict";function n(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function r(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function t(e,n,t){return n&&r(e.prototype,n),t&&r(e,t),e}function e(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var l="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),s=new Uint8Array(16);for(var d=[],o=0;o<256;++o)d[o]=(o+256).toString(16).substr(1);function a(e,n,t){var r=n&&t||0;"string"==typeof e&&(n="binary"===e?new Array(16):null,e=null);var o,a,u,i=(e=e||{}).random||(e.rng||function(){if(!l)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return l(s)})();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,n)for(var c=0;c<16;++c)n[r+c]=i[c];return n||(u=a||0,[d[(o=i)[u++]],d[o[u++]],d[o[u++]],d[o[u++]],"-",d[o[u++]],d[o[u++]],"-",d[o[u++]],d[o[u++]],"-",d[o[u++]],d[o[u++]],"-",d[o[u++]],d[o[u++]],d[o[u++]],d[o[u++]],d[o[u++]],d[o[u++]]].join(""))}var u=function(){function r(e){n(this,r),r._documentHandler=e,r._uuid=a(),r._generalHTMLAttributes={error:[{name:"class",value:"error"}],ok:[{name:"class",value:"ok"}],chatHistory:function(e,n){return[{name:"class",value:"user-message ".concat(e," ").concat(n)},{name:"id",value:e}]}},r._documentHandler.createEvent("init-chat","click",function(){""==(r._nickname=r._documentHandler.valueByID("nickname"))?r._documentHandler.createElement("container-information","span","You must put a nickname to start!",r._generalHTMLAttributes.error):r.start(function(e,n){if(e){r._documentHandler.removeElement("container-information");var t=JSON.stringify({nickname:r._nickname,uuid:r._uuid,message:"ping"});document.getElementById("container-chat").style="display: flex",r._wsConnection.send(t),r.initSender(),r.initReceiver()}else r._documentHandler.createElement("container-information","span","Something is wrong:"+n,r._generalHTMLAttributes.error);r._wsConnection.onerror=function(e){console.log(e)}})})}return t(r,null,[{key:"start",value:function(n){var e=new WebSocket("ws://localhost:8000?uuid="+r._uuid);(r._wsConnection=e).onopen=function(){r._documentHandler.createElement("status-wsConn","div","Now you are connected!",r._generalHTMLAttributes.ok),n(!0,null)},e.onerror=function(e){r._documentHandler.createElement("status-wsConn","span","Connection refused!",r._generalHTMLAttributes.error),n(!1,e)}}},{key:"initSender",value:function(){r._documentHandler.createEvent("send-data","click",function(){var e=r._documentHandler.valueByID("message"),n=JSON.stringify({nickname:r._nickname,uuid:r._uuid,message:e});r._wsConnection.send(n)})}},{key:"initReceiver",value:function(){r._wsConnection.onmessage=function(e){var n=JSON.parse(e.data),t=n.message;t="ping"===t?"[".concat(n.nickname,"]: now is connected!"):"[".concat(n.nickname,"]: ").concat(t," "),r._documentHandler.createElement("chat-history","span",t,r._generalHTMLAttributes.chatHistory(n.uuid,r._uuid))}}}]),r}();e(u,"_documentHandler",null),e(u,"_wsConnection",null),e(u,"_uuid",null),e(u,"_nickname",null),new u(new(function(){function e(){n(this,e)}return t(e,[{key:"createEvent",value:function(e,n,t){document.getElementById(e).addEventListener(n,t)}},{key:"valueByID",value:function(e){return document.getElementById(e).value}},{key:"removeElement",value:function(e){document.getElementById(e).remove()}},{key:"createElement",value:function(e,n,t,r){var o=document.createElement(n);r.map(function(e){o.setAttribute(e.name,e.value)});var a=document.createTextNode(t);o.appendChild(a),document.getElementById(e).appendChild(o)}}]),e}()))}();
